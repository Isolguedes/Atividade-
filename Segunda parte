<script>
  const input = document.getElementById("tarefaInput");
  const lista = document.getElementById("listaTarefas");

  // Carregar tarefas salvas ao iniciar a página
  window.onload = () => {
    const tarefasSalvas = JSON.parse(localStorage.getItem("tarefas")) || [];
    tarefasSalvas.forEach(t => criarTarefa(t.texto, t.feito));
  };

  // Adicionar tarefa com botão
  function adicionarTarefa() {
    const texto = input.value.trim();
    if (!texto) return alert("Digite uma tarefa!");
    criarTarefa(texto, false);
    input.value = "";
    salvarTarefas();
  }

  // Adicionar tarefa apertando Enter
  input.addEventListener("keypress", (e) => {
    if (e.key === "Enter") {
      adicionarTarefa();
    }
  });

  // Criar tarefa na lista
  function criarTarefa(texto, feito) {
    const li = document.createElement("li");

    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";

    const span = document.createElement("span");
    span.textContent = texto;

    if (feito) {
      span.classList.add("feito");
      checkbox.checked = true;
    }

    checkbox.onclick = () => {
      span.classList.toggle("feito");
      salvarTarefas();
    };

    const acoes = document.createElement("div");
    acoes.className = "acoes";

    const btnEditar = document.createElement("button");
    btnEditar.textContent = "✏️";
    btnEditar.onclick = () => {
      const novoTexto = prompt("Edite a tarefa:", span.textContent);
      if (novoTexto) {
        span.textContent = novoTexto;
        salvarTarefas();
      }
    };

    const btnRemover = document.createElement("button");
    btnRemover.textContent = "❌";
    btnRemover.onclick = () => {
      li.remove();
      salvarTarefas();
    };

    acoes.appendChild(btnEditar);
    acoes.appendChild(btnRemover);

    li.appendChild(checkbox);
    li.appendChild(span);
    li.appendChild(acoes);

    lista.appendChild(li);
  }

  // Limpar todas as tarefas
  function limparTudo() {
    if (confirm("Deseja realmente limpar todas as tarefas?")) {
      lista.innerHTML = "";
      localStorage.removeItem("tarefas");
    }
  }

  // Salvar tarefas no localStorage
  function salvarTarefas() {
    const tarefas = [];
    lista.querySelectorAll("li").forEach(li => {
      const texto = li.querySelector("span").textContent;
      const feito = li.querySelector("input[type=checkbox]").checked;
      tarefas.push({ texto, feito });
    });
    localStorage.setItem("tarefas", JSON.stringify(tarefas));
  }
</script>
